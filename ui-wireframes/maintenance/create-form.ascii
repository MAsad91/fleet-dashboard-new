```
┌────────────────────────────────────────────────────────────────────────────────┐
│ HEADER                                                                         │
│  Fleet Admin > Maintenance > Schedule Maintenance                           [👤]│
├────────────────────────────────────────────────────────────────────────────────┤
│                                                                                │
│ SCHEDULE MAINTENANCE                                                           │
│ ┌────────────────────────────────────────────────────────────────────────────┐ │
│ │ Vehicle Information                                                       │ │
│ ├────────────────────────────────────────────────────────────────────────────┤ │
│ │                                                                            │ │
│ │ Vehicle*                                                                   │ │
│ │ ┌─────────────────────────────────────────────┐                           │ │
│ │ │ Select Vehicle...                         ▾ │                           │ │
│ │ └─────────────────────────────────────────────┘                           │ │
│ │ Note: Shows all vehicles with their status                                │ │
│ │                                                                            │ │
│ │ Fleet Operator*                                                           │ │
│ │ ┌─────────────────────────────────────────────┐                           │ │
│ │ │ Acme Logistics                            ▾ │                           │ │
│ │ └─────────────────────────────────────────────┘                           │ │
│ │ Note: Pre-selected based on vehicle                                       │ │
│ │                                                                            │ │
│ └────────────────────────────────────────────────────────────────────────────┘ │
│                                                                                │
│ ┌────────────────────────────────────────────────────────────────────────────┐ │
│ │ Service Details                                                           │ │
│ ├────────────────────────────────────────────────────────────────────────────┤ │
│ │                                                                            │ │
│ │ Service Type*                                 Priority*                    │ │
│ │ ┌─────────────────────────────┐               ┌─────────────────────────┐ │ │
│ │ │ Select Type...            ▾ │               │ Medium                ▾ │ │ │
│ │ └─────────────────────────────┘               └─────────────────────────┘ │ │
│ │ Options: Inspection, Brake Service, etc.       Options: Low, Medium, High │ │
│ │                                                                            │ │
│ │ Description*                                                               │ │
│ │ ┌───────────────────────────────────────────────────────────────────────┐ │ │
│ │ │                                                                       │ │ │
│ │ │                                                                       │ │ │
│ │ │                                                                       │ │ │
│ │ └───────────────────────────────────────────────────────────────────────┘ │ │
│ │                                                                            │ │
│ │ Service Location*                                                          │ │
│ │ ┌─────────────────────────────────────────────┐                           │ │
│ │ │ Select Location...                        ▾ │                           │ │
│ │ └─────────────────────────────────────────────┘                           │ │
│ │ Options: Service centers, garages, etc.                                    │ │
│ │                                                                            │ │
│ └────────────────────────────────────────────────────────────────────────────┘ │
│                                                                                │
│ ┌────────────────────────────────────────────────────────────────────────────┐ │
│ │ Scheduling                                                                │ │
│ ├────────────────────────────────────────────────────────────────────────────┤ │
│ │                                                                            │ │
│ │ Date*                                         Time Slot*                   │ │
│ │ ┌─────────────────────────────┐               ┌─────────────────────────┐ │ │
│ │ │ YYYY-MM-DD                │               │ 14:00 - 16:00         ▾ │ │ │
│ │ └─────────────────────────────┘               └─────────────────────────┘ │ │
│ │                                               Options: Time slots         │ │
│ │                                                                            │ │
│ │ Duration*                                     Technician*                  │ │
│ │ ┌─────────────────────────────┐               ┌─────────────────────────┐ │ │
│ │ │ 2                        hours│               │ Select Technician...  ▾ │ │ │
│ │ └─────────────────────────────┘               └─────────────────────────┘ │ │
│ │                                               Options: Available technicians│ │
│ │                                                                            │ │
│ └────────────────────────────────────────────────────────────────────────────┘ │
│                                                                                │
│ ┌────────────────────────────────────────────────────────────────────────────┐ │
│ │ Parts & Costs                                                             │ │
│ ├────────────────────────────────────────────────────────────────────────────┤ │
│ │                                                                            │ │
│ │ Parts                                                                      │ │
│ │ ┌──────────────────┬────────────┬─────────────┬────────────────────────┐  │ │
│ │ │ Item            │ Quantity   │ Unit Cost   │ Total Cost            │  │ │
│ │ ├──────────────────┼────────────┼─────────────┼────────────────────────┤  │ │
│ │ │ [Select Part ▾] │ [        ] │ [         ] │ [Calculated]          │  │ │
│ │ │ [Select Part ▾] │ [        ] │ [         ] │ [Calculated]          │  │ │
│ │ │ [+ Add Part]                                                       │  │ │
│ │ └──────────────────┴────────────┴─────────────┴────────────────────────┘  │ │
│ │                                                                            │ │
│ │ Total Estimated Cost                                                       │ │
│ │ ┌─────────────────────────────────────────────┐                           │ │
│ │ │                                          ₹ │ [Calculate]               │ │
│ │ └─────────────────────────────────────────────┘                           │ │
│ │                                                                            │ │
│ └────────────────────────────────────────────────────────────────────────────┘ │
│                                                                                │
│ ┌────────────────────────────────────────────────────────────────────────────┐ │
│ │ Notes & Attachments                                                       │ │
│ ├────────────────────────────────────────────────────────────────────────────┤ │
│ │                                                                            │ │
│ │ Notes                                                                      │ │
│ │ ┌───────────────────────────────────────────────────────────────────────┐ │ │
│ │ │                                                                       │ │ │
│ │ │                                                                       │ │ │
│ │ └───────────────────────────────────────────────────────────────────────┘ │ │
│ │                                                                            │ │
│ │ Attachments                                                                │ │
│ │ [Upload File]                                                              │ │
│ │                                                                            │ │
│ └────────────────────────────────────────────────────────────────────────────┘ │
│                                                                                │
│                                         [Cancel]   [Schedule Maintenance]      │
│                                                                                │
└────────────────────────────────────────────────────────────────────────────────┘
```

## Implementation Guide

### Data Sources

#### Vehicle Information

- **Vehicle*** (searchable dropdown):
  - **API**: `GET /api/fleet/vehicles/`
  - **Display**: License plate, make, model, status
  - **Behavior**: When selected, auto-fills fleet operator

- **Fleet Operator*** (dropdown):
  - **API**: `GET /api/fleet/fleet-operators/`
  - **Pre-selection**: Based on selected vehicle
  - **Behavior**: Non-admin users have this pre-selected and disabled

#### Service Details

- **Service Type*** (dropdown):
  - **API**: `GET /api/fleet/maintenance/service-types/` (if implemented)
  - **Alternative**: Hardcoded list of common service types
  - **Options**: Inspection, Brake Service, Tire Rotation, etc.

- **Priority*** (dropdown):
  - **Options**: Low, Medium, High
  - **Default**: Medium

- **Description*** (textarea):
  - **Validation**: Required
  - **Purpose**: Detailed description of the maintenance service

- **Service Location*** (dropdown):
  - **API**: `GET /api/fleet/maintenance/locations/` (if implemented)
  - **Alternative**: Hardcoded list of service centers
  - **Options**: Service centers, garages, etc.

#### Scheduling

- **Date*** (date picker):
  - **Format**: YYYY-MM-DD
  - **Validation**: Must be in the future
  - **Behavior**: When selected, enables appropriate time slots

- **Time Slot*** (dropdown):
  - **Options**: Available time slots (e.g., 08:00-10:00, 10:00-12:00, etc.)
  - **Behavior**: Shows available slots based on selected date

- **Duration*** (number + unit):
  - **Validation**: Positive number
  - **Default**: Based on service type or 2 hours

- **Technician*** (dropdown):
  - **API**: `GET /api/fleet/technicians/?available_date=2025-09-25&available_time=14:00`
  - **Display**: Technician name and expertise
  - **Options**: Filtered by availability for selected date/time

#### Parts & Costs

- **Parts** (dynamic form):
  - **API for Parts Dropdown**: `GET /api/fleet/parts/`
  - **Fields**: Item, Quantity, Unit Cost, Total Cost (calculated)
  - **Behavior**: "Add Part" button adds new rows

- **Total Estimated Cost** (calculated):
  - **Calculation**: Sum of all parts' total costs
  - **Button**: Calculate refreshes the total

#### Notes & Attachments

- **Notes** (textarea):
  - **Purpose**: Additional instructions or context for technicians

- **Attachments** (file upload):
  - **Purpose**: Reference documents, manuals, etc.
  - **File Types**: PDF, images, etc.

### Form Submission

- **API Endpoint**: `POST /api/fleet/maintenance/`
- **Request Body**:
  ```json
  {
    "vehicle": 5,
    "fleet_operator": 1,
    "service_type": "Brake Service",
    "description": "Complete brake pad replacement and brake fluid flush for all wheels.",
    "priority": "High",
    "service_location": 3,
    "scheduled_date": "2025-09-25",
    "scheduled_time_start": "14:00",
    "scheduled_time_end": "16:00",
    "duration_hours": 2,
    "technician": 7,
    "parts": [
      {
        "item": "Brake Pads (Front)",
        "quantity": 2,
        "unit_cost": 800,
        "total_cost": 1600
      },
      {
        "item": "Brake Pads (Rear)",
        "quantity": 2,
        "unit_cost": 700,
        "total_cost": 1400
      },
      {
        "item": "Brake Fluid",
        "quantity": 1,
        "unit_cost": 500,
        "total_cost": 500
      }
    ],
    "total_cost": 3500,
    "notes": "Vehicle previously reported brake noise at high speeds.",
    "attachments": [
      {
        "file": <binary_data>,
        "filename": "Service_Manual_Reference.pdf"
      }
    ]
  }
  ```

### Edit Form Behavior

When using the same form for editing:

- **API Endpoint**: `PUT/PATCH /api/fleet/maintenance/{id}/`
- **Pre-population**: Fetch maintenance record details and populate all form fields
- **Button Label**: Change to "Update Maintenance"

### Validation Rules

- **Required Fields**: All fields marked with * are required
- **Date**: Must be in the future
- **Duration**: Must be a positive number
- **Parts**: If added, must have valid quantity and unit cost
- **Total Cost**: Must be calculated or entered

### User Experience

- **Dynamic Forms**: Parts section allows adding multiple rows
- **Auto-calculation**: Total costs are calculated automatically
- **Field Dependencies**: Technician availability based on date/time
- **Date Picker**: Calendar UI for date selection
- **Time Slots**: Show only available slots
- **File Upload**: Support for multiple attachments

### After Submission

- **Success**: Redirect to maintenance detail page with success message
- **Error**: Show validation errors inline with fields and summary at top
